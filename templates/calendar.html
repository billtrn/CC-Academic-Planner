{% extends "layout.html" %}
{% block content %}
<div class="row">
    <div class="col-md-9">
        <head>
            <title>Class Schedule</title>
            <link rel="stylesheet" type="text/css" href="../static/assets/css/calendar.css" />
        </head>
        <body>
            <!-- <h2 class="text-primary">Connecticut College Academic Planner<br/></h2> -->
            <table>
                <body>
                    <tr>
                        <th>Time</th>
                        <th>MON</th>
                        <th>TUES</th>
                        <th>WED</th>
                        <th>THUR</th>
                        <th>FRI</th>
                        <th>SAT</th>
                        <th>SUN</th>
                    </tr>
                    <tr>
                        <td>8:00 AM</td>
                        <td id="M800"></td>
                        <td id="T800"></td>
                        <td id="W800"></td>
                        <td id="R800"></td>
                        <td id="F800"></td>
                        <td id="S800"></td>
                        <td id="SU800"></td>
                    </tr>
                    <tr>
                        <td>8:15 AM</td>
                        <td id="M815"></td>
                        <td id="T815"></td>
                        <td id="W815"></td>
                        <td id="R815"></td>
                        <td id="F815"></td>
                        <td id="S815"></td>
                        <td id="SU815"></td>
                    </tr>
                    <tr>
                        <td>8:30 AM</td>
                        <td id="M830"></td>
                        <td id="T830"></td>
                        <td id="W830"></td>
                        <td id="R830"></td>
                        <td id="F830"></td>
                        <td id="S830"></td>
                        <td id="SU830"></td>
                    </tr>
                    <tr>
                        <td>8:45 AM</td>
                        <td id="M845"></td>
                        <td id="T845"></td>
                        <td id="W845"></td>
                        <td id="R845"></td>
                        <td id="F845"></td>
                        <td id="S845"></td>
                        <td id="SU845"></td>
                    </tr>
                    <tr>
                        <td>9:00 AM</td>
                        <td id="M900"></td>
                        <td id="T900"></td>
                        <td id="W900"></td>
                        <td id="R900"></td>
                        <td id="F900"></td>
                        <td id="S900"></td>
                        <td id="SU900"></td>
                    </tr>
                    <tr>
                        <td>9:15 AM</td>
                        <td id="M915"></td>
                        <td id="T915"></td>
                        <td id="W915"></td>
                        <td id="R915"></td>
                        <td id="F915"></td>
                        <td id="S915"></td>
                        <td id="SU915"></td>
                    </tr>
                    <tr>
                        <td>9:30 AM</td>
                        <td id="M930"></td>
                        <td id="T930"></td>
                        <td id="W930"></td>
                        <td id="R930"></td>
                        <td id="F930"></td>
                        <td id="S930"></td>
                        <td id="SU930"></td>
                    </tr>
                    <tr>
                        <td>9:45 AM</td>
                        <td id="M945"></td>
                        <td id="T945"></td>
                        <td id="W945"></td>
                        <td id="R945"></td>
                        <td id="F945"></td>
                        <td id="S945"></td>
                        <td id="SU945"></td>
                    </tr>
                    <tr>
                        <td>10:00 AM</td>
                        <td id="M1000"></td>
                        <td id="T1000"></td>
                        <td id="W1000"></td>
                        <td id="R1000"></td>
                        <td id="F1000"></td>
                        <td id="S1000"></td>
                        <td id="SU1000"></td>
                    </tr>
                    <tr>
                        <td>10:15 AM</td>
                        <td id="M1015"></td>
                        <td id="T1015"></td>
                        <td id="W1015"></td>
                        <td id="R1015"></td>
                        <td id="F1015"></td>
                        <td id="S1015"></td>
                        <td id="SU1015"></td>
                    </tr>
                    <tr>
                        <td>10:30 AM</td>
                        <td id="M1030"></td>
                        <td id="T1030"></td>
                        <td id="W1030"></td>
                        <td id="R1030"></td>
                        <td id="F1030"></td>
                        <td id="S1030"></td>
                        <td id="SU1030"></td>
                    </tr>
                    <tr>
                        <td>10:45 AM</td>
                        <td id="M1045"></td>
                        <td id="T1045"></td>
                        <td id="W1045"></td>
                        <td id="R1045"></td>
                        <td id="F1045"></td>
                        <td id="S1045"></td>
                        <td id="SU1045"></td>
                    </tr>
                    <tr>
                        <td>11:00 AM</td>
                        <td id="M1100"></td>
                        <td id="T1100"></td>
                        <td id="W1100"></td>
                        <td id="R1100"></td>
                        <td id="F1100"></td>
                        <td id="S1100"></td>
                        <td id="SU1100"></td>
                    </tr>
                    <tr>
                        <td>11:15 AM</td>
                        <td id="M1115"></td>
                        <td id="T1115"></td>
                        <td id="W1115"></td>
                        <td id="R1115"></td>
                        <td id="F1115"></td>
                        <td id="S1115"></td>
                        <td id="SU1115"></td>
                    </tr>
                    <tr>
                        <td>11:30 AM</td>
                        <td id="M1130"></td>
                        <td id="T1130"></td>
                        <td id="W1130"></td>
                        <td id="R1130"></td>
                        <td id="F1130"></td>
                        <td id="S1130"></td>
                        <td id="SU1130"></td>
                    </tr>
                    <tr>
                        <td>11:45 AM</td>
                        <td id="M1145"></td>
                        <td id="T1145"></td>
                        <td id="W1145"></td>
                        <td id="R1145"></td>
                        <td id="F1145"></td>
                        <td id="S1145"></td>
                        <td id="SU1145"></td>
                    </tr>
                    <tr>
                        <td>12:00 PM</td>
                        <td id="M1200"></td>
                        <td id="T1200"></td>
                        <td id="W1200"></td>
                        <td id="R1200"></td>
                        <td id="F1200"></td>
                        <td id="S1200"></td>
                        <td id="SU1200"></td>
                    </tr>
                    <tr>
                        <td>12:15 PM</td>
                        <td id="M1215"></td>
                        <td id="T1215"></td>
                        <td id="W1215"></td>
                        <td id="R1215"></td>
                        <td id="F1215"></td>
                        <td id="S1215"></td>
                        <td id="SU1215"></td>
                    </tr>
                    <tr>
                        <td>12:30 PM</td>
                        <td id="M1230"></td>
                        <td id="T1230"></td>
                        <td id="W1230"></td>
                        <td id="R1230"></td>
                        <td id="F1230"></td>
                        <td id="S1230"></td>
                        <td id="SU1230"></td>
                    </tr>
                    <tr>
                        <td>12:45 PM</td>
                        <td id="M1245"></td>
                        <td id="T1245"></td>
                        <td id="W1245"></td>
                        <td id="R1245"></td>
                        <td id="F1245"></td>
                        <td id="S1245"></td>
                        <td id="SU1245"></td>
                    </tr>
                    <tr>
                        <td>1:00 PM</td>
                        <td id="M1300"></td>
                        <td id="T1300"></td>
                        <td id="W1300"></td>
                        <td id="R1300"></td>
                        <td id="F1300"></td>
                        <td id="S1300"></td>
                        <td id="SU1300"></td>
                    </tr>
                    <tr>
                        <td>1:15 PM</td>
                        <td id="M1315"></td>
                        <td id="T1315"></td>
                        <td id="W1315"></td>
                        <td id="R1315"></td>
                        <td id="F1315"></td>
                        <td id="S1315"></td>
                        <td id="SU1315"></td>
                    </tr>
                    <tr>
                        <td>1:30 PM</td>
                        <td id="M1330"></td>
                        <td id="T1330"></td>
                        <td id="W1330"></td>
                        <td id="R1330"></td>
                        <td id="F1330"></td>
                        <td id="S1330"></td>
                        <td id="SU1330"></td>
                    </tr>
                    <tr>
                        <td>1:45 PM</td>
                        <td id="M1345"></td>
                        <td id="T1345"></td>
                        <td id="W1345"></td>
                        <td id="R1345"></td>
                        <td id="F1345"></td>
                        <td id="S1345"></td>
                        <td id="SU1345"></td>
                    </tr>
                    <tr>
                        <td>2:00 PM</td>
                        <td id="M1400"></td>
                        <td id="T1400"></td>
                        <td id="W1400"></td>
                        <td id="R1400"></td>
                        <td id="F1400"></td>
                        <td id="S1400"></td>
                        <td id="SU1400"></td>
                    </tr>
                    <tr>
                        <td>2:15 PM</td>
                        <td id="M1415"></td>
                        <td id="T1415"></td>
                        <td id="W1415"></td>
                        <td id="R1415"></td>
                        <td id="F1415"></td>
                        <td id="S1415"></td>
                        <td id="SU1415"></td>
                    </tr>
                    <tr>
                        <td>2:30 PM</td>
                        <td id="M1430"></td>
                        <td id="T1430"></td>
                        <td id="W1430"></td>
                        <td id="R1430"></td>
                        <td id="F1430"></td>
                        <td id="S1430"></td>
                        <td id="SU1430"></td>
                    </tr>
                    <tr>
                        <td>2:45 PM</td>
                        <td id="M1445"></td>
                        <td id="T1445"></td>
                        <td id="W1445"></td>
                        <td id="R1445"></td>
                        <td id="F1445"></td>
                        <td id="S1445"></td>
                        <td id="SU1445"></td>
                    </tr>
                    <tr>
                        <td>3:00 PM</td>
                        <td id="M1500"></td>
                        <td id="T1500"></td>
                        <td id="W1500"></td>
                        <td id="R1500"></td>
                        <td id="F1500"></td>
                        <td id="S1500"></td>
                        <td id="SU1500"></td>
                    </tr>
                    <tr>
                        <td>3:15 PM</td>
                        <td id="M1515"></td>
                        <td id="T1515"></td>
                        <td id="W1515"></td>
                        <td id="R1515"></td>
                        <td id="F1515"></td>
                        <td id="S1515"></td>
                        <td id="SU1515"></td>
                    </tr>
                    <tr>
                        <td>3:30 PM</td>
                        <td id="M1530"></td>
                        <td id="T1530"></td>
                        <td id="W1530"></td>
                        <td id="R1530"></td>
                        <td id="F1530"></td>
                        <td id="S1530"></td>
                        <td id="SU1530"></td>
                    </tr>
                    <tr>
                        <td>3:45 PM</td>
                        <td id="M1545"></td>
                        <td id="T1545"></td>
                        <td id="W1545"></td>
                        <td id="R1545"></td>
                        <td id="F1545"></td>
                        <td id="S1545"></td>
                        <td id="SU1545"></td>
                    </tr>
                    <tr>
                        <td>4:00 PM</td>
                        <td id="M1600"></td>
                        <td id="T1600"></td>
                        <td id="W1600"></td>
                        <td id="R1600"></td>
                        <td id="F1600"></td>
                        <td id="S1600"></td>
                        <td id="SU1600"></td>
                    </tr>
                    <tr>
                        <td>4:15 PM</td>
                        <td id="M1615"></td>
                        <td id="T1615"></td>
                        <td id="W1615"></td>
                        <td id="R1615"></td>
                        <td id="F1615"></td>
                        <td id="S1615"></td>
                        <td id="SU1615"></td>
                    </tr>
                    <tr>
                        <td>4:30 PM</td>
                        <td id="M1630"></td>
                        <td id="T1630"></td>
                        <td id="W1630"></td>
                        <td id="R1630"></td>
                        <td id="F1630"></td>
                        <td id="S1630"></td>
                        <td id="SU1630"></td>
                    </tr>
                    <tr>
                        <td>4:45 PM</td>
                        <td id="M1645"></td>
                        <td id="T1645"></td>
                        <td id="W1645"></td>
                        <td id="R1645"></td>
                        <td id="F1645"></td>
                        <td id="S1645"></td>
                        <td id="SU1645"></td>
                    </tr>
                    <tr>
                        <td>5:00 PM</td>
                        <td id="M1700"></td>
                        <td id="T1700"></td>
                        <td id="W1700"></td>
                        <td id="R1700"></td>
                        <td id="F1700"></td>
                        <td id="S1700"></td>
                        <td id="SU1700"></td>
                    </tr>
                    <tr>
                        <td>5:15 PM</td>
                        <td id="M1715"></td>
                        <td id="T1715"></td>
                        <td id="W1715"></td>
                        <td id="R1715"></td>
                        <td id="F1715"></td>
                        <td id="S1715"></td>
                        <td id="SU1715"></td>
                    </tr>
                    <tr>
                        <td>5:30 PM</td>
                        <td id="M1730"></td>
                        <td id="T1730"></td>
                        <td id="W1730"></td>
                        <td id="R1730"></td>
                        <td id="F1730"></td>
                        <td id="S1730"></td>
                        <td id="SU1730"></td>
                    </tr>
                    <tr>
                        <td>5:45 PM</td>
                        <td id="M1745"></td>
                        <td id="T1745"></td>
                        <td id="W1745"></td>
                        <td id="R1745"></td>
                        <td id="F1745"></td>
                        <td id="S1745"></td>
                        <td id="SU1745"></td>
                    </tr>
                    <tr>
                        <td>6:00 PM</td>
                        <td id="M1800"></td>
                        <td id="T1800"></td>
                        <td id="W1800"></td>
                        <td id="R1800"></td>
                        <td id="F1800"></td>
                        <td id="S1800"></td>
                        <td id="SU1800"></td>
                    </tr>
                    <tr>
                        <td>6:15 PM</td>
                        <td id="M1815"></td>
                        <td id="T1815"></td>
                        <td id="W1815"></td>
                        <td id="R1815"></td>
                        <td id="F1815"></td>
                        <td id="S1815"></td>
                        <td id="SU1815"></td>
                    </tr>
                    <tr>
                        <td>6:30 PM</td>
                        <td id="M1830"></td>
                        <td id="T1830"></td>
                        <td id="W1830"></td>
                        <td id="R1830"></td>
                        <td id="F1830"></td>
                        <td id="S1830"></td>
                        <td id="SU1830"></td>
                    </tr>
                    <tr>
                        <td>6:45 PM</td>
                        <td id="M1845"></td>
                        <td id="T1845"></td>
                        <td id="W1845"></td>
                        <td id="R1845"></td>
                        <td id="F1845"></td>
                        <td id="S1845"></td>
                        <td id="SU1845"></td>
                    </tr>
                    <tr>
                        <td>7:00 PM</td>
                        <td id="M1900"></td>
                        <td id="T1900"></td>
                        <td id="W1900"></td>
                        <td id="R1900"></td>
                        <td id="F1900"></td>
                        <td id="S1900"></td>
                        <td id="SU1900"></td>
                    </tr>
                    <tr>
                        <td>7:15 PM</td>
                        <td id="M1915"></td>
                        <td id="T1915"></td>
                        <td id="W1915"></td>
                        <td id="R1915"></td>
                        <td id="F1915"></td>
                        <td id="S1915"></td>
                        <td id="SU1915"></td>
                    </tr>
                    <tr>
                        <td>7:30 PM</td>
                        <td id="M1930"></td>
                        <td id="T1930"></td>
                        <td id="W1930"></td>
                        <td id="R1930"></td>
                        <td id="F1930"></td>
                        <td id="S1930"></td>
                        <td id="SU1930"></td>
                    </tr>
                    <tr>
                        <td>7:45 PM</td>
                        <td id="M1945"></td>
                        <td id="T1945"></td>
                        <td id="W1945"></td>
                        <td id="R1945"></td>
                        <td id="F1945"></td>
                        <td id="S1945"></td>
                        <td id="SU1945"></td>
                    </tr>
                    <tr>
                        <td>8:00 PM</td>
                        <td id="M2000"></td>
                        <td id="T2000"></td>
                        <td id="W2000"></td>
                        <td id="R2000"></td>
                        <td id="F2000"></td>
                        <td id="S2000"></td>
                        <td id="SU2000"></td>
                    </tr>
                    <tr>
                        <td>8:15 PM</td>
                        <td id="M2015"></td>
                        <td id="T2015"></td>
                        <td id="W2015"></td>
                        <td id="R2015"></td>
                        <td id="F2015"></td>
                        <td id="S2015"></td>
                        <td id="SU2015"></td>
                    </tr>
                    <tr>
                        <td>8:30 PM</td>
                        <td id="M2030"></td>
                        <td id="T2030"></td>
                        <td id="W2030"></td>
                        <td id="R2030"></td>
                        <td id="F2030"></td>
                        <td id="S2030"></td>
                        <td id="SU2030"></td>
                    </tr>
                    <tr>
                        <td>8:45 PM</td>
                        <td id="M2045"></td>
                        <td id="T2045"></td>
                        <td id="W2045"></td>
                        <td id="R2045"></td>
                        <td id="F2045"></td>
                        <td id="S2045"></td>
                        <td id="SU2045"></td>
                    </tr>
                    <tr>
                        <td>9:00 PM</td>
                        <td id="M2100"></td>
                        <td id="T2100"></td>
                        <td id="W2100"></td>
                        <td id="R2100"></td>
                        <td id="F2100"></td>
                        <td id="S2100"></td>
                        <td id="SU2100"></td>
                    </tr>
                    <tr>
                        <td>9:15 PM</td>
                        <td id="M2115"></td>
                        <td id="T2115"></td>
                        <td id="W2115"></td>
                        <td id="R2115"></td>
                        <td id="F2115"></td>
                        <td id="S2115"></td>
                        <td id="SU2115"></td>
                    </tr>
                    <tr>
                        <td>9:30 PM</td>
                        <td id="M2130"></td>
                        <td id="T2130"></td>
                        <td id="W2130"></td>
                        <td id="R2130"></td>
                        <td id="F2130"></td>
                        <td id="S2130"></td>
                        <td id="SU2130"></td>
                    </tr>
                    <tr>
                        <td>9:45 PM</td>
                        <td id="M2145"></td>
                        <td id="T2145"></td>
                        <td id="W2145"></td>
                        <td id="R2145"></td>
                        <td id="F2145"></td>
                        <td id="S2145"></td>
                        <td id="SU2145"></td>
                    </tr>
                </body>
            </table>
            <script>
                var ds = ["M", "T", "W", "R", "F", "S", "SU"];
                var colors = ["course-one", "course-two", "course-three", "course-four", "course-five", "course-six", "course-seven", "course-eight", "course-nine", "course-ten"]
                var courses = JSON.parse('{{ courses | tojson | safe }}');
                console.log(courses);
                for(j=0; j<courses.length; j++){
                    console.log(j)
                    var course = courses[j];
                    var times = course.times;
                    var days = course.days;
                    
                    for(x=0; x<days.length; x++)
                    {
                        var start = parseInt(times[x].split("-")[0]);
                        var end = parseInt(times[x].split("-")[1]);

                        var startm = start % 100;
                        var endm = end % 100;

                        if(startm % 15 != 0){
                            var startmround = (((startm + 7.5)/15 | 0) * 15) % 60;
                            start = start - startm + startmround;
                        }
                        if(endm % 15 != 0)
                        {
                            var endmround = (((endm + 7.5)/15 | 0) * 15) % 60;
                            end = end - endm + endmround;
                        }

                        var d;
                        for(d of ds){
                            if (days[x].includes(d)){
                                var split = course.times[x].split("-");
                                var start_string = split[0].substring(0,2) + ":" + split[0].substring(2,4);
                                var end_string = split[1].substring(0,2) + ":" + split[1].substring(2,4);

                                var start_int = parseInt(split[0]);
                                var end_int = parseInt(split[1]);
                                if(start_int/100 >= 13){
                                    start_string = (Math.floor(start_int/100)-12) + ":" + split[0].substring(2,4);
                                }
                                if(end_int/100 >= 13){
                                    end_string = (Math.floor(end_int/100)-12) + ":" + split[1].substring(2,4);
                                }
                                var i = start;
                                var b = 0;
                                while(i < end){
                                    if(b>0){
                                        document.getElementById(d+i).remove();
                                    }
                                    if(i % 100 == 45){
                                        i += 55;
                                    }
                                    else{
                                        i += 15;
                                    }
                                    b+=1;
                                }
                                document.getElementById(d+start).rowSpan = b+1;
                                document.getElementById(d+start).innerHTML = course.dept + " " + course.number + "<br>" + course.title + "<br>" + start_string + " - " + end_string + "<br> CRN: " + course.crn;
                                color = j%10;
                                document.getElementById(d+start).className = colors[color];

                            }
                        }
                    }
                }
            </script>
        </body>
    </div>
    <div class="col-md-3">
        <div class="content-section">
            <h4>Add a course</h4>
            <form method="POST" action="">
                {{ form.hidden_tag() }}
                <fieldset class="form-group">
                    <div class="form-group">
                        {{ form.department.label(class="form-control-label") }}
                        {{ form.department(class="form-control form-control-lg", style="font-size: small") }}
                        {{ form.course.label(class="form-control-label") }}
                        {{ form.course(class="form-control form-control-lg", style="font-size: small") }}
                    </div>
                    <script>
                        let dept_select = document.getElementById('department');
                        let course_select = document.getElementById('course');
            
                        dept_select.onchange = function() {
                            dept = dept_select.value;
                            
                            fetch('/course/' + dept).then(function(response) {
                                response.json().then(function(data) {
                                    let optionHTML = '';
                                    for (let course of data.courses) {
                                        optionHTML += '<option value="' + course + '">' + course + '</option>';
                                    }
                                    course_select.innerHTML = optionHTML;
                                })
                            });
                        }
                    </script>
                </fieldset>
                <div class="form-group">
                    {{ form.submit(class="btn btn-outline-info") }}
                </div>
            </form>
        </div>
        <!-- <div>
            <form method="POST" action="">
                {{ cform.hidden_tag() }}
                <div class="form-group">
                    {{ cform.clear(class="btn btn-poutline-info") }}
                </div>
            </form>
        </div> -->
        <div>
            <form method="POST" action="">
                {{ rform.hidden_tag() }}
                <fieldset class="form-group">
                    <div class="form-group">
                        {{ rform.selcourses.label(class="form-control-label") }}
                        {{ rform.selcourses(class="form-control form-control-lg", style="font-size: small") }}
                    </div>
                </fieldset>
                <div class="form-group">
                    {{ rform.rem(class="btn btn-poutline-info") }}
                </div>
            </form>
        </div>
        {% if error %}
            <p class=error><strong>CONFLICT:</strong> {{ error }}
        {% endif %}
    </div>
</div>
{% endblock content %}